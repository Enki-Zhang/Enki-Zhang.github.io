---
title: 秒杀项目
top: false
cover: false
toc: true
mathjax: true
date: 2024-01-11 09:35:22
password:
summary:
tags:
categories:
---

## 如何解决超卖问题

扣减库存时候，要保证数据库中的字段值不能为负数，

1. 通常在扣减库存的场景下使用行级锁，通过数据库引擎本身对记录加锁的控制，保证数据库的更新的安全性，并且通过 where 语句的条件，保证库存不会被减到 0 以下。意思是在 sql 语句对数据库进行操作时候进行控制。
2. 通过对库存字段设置为无符号型 那么出现负数则报错。
   简单的在操作数据库的时候给 SQL 语句加上限定只有库存量大于 0 才能够减库存
   内存标记并预减库存
   超卖现象是多线程安全问题，使用乐观锁

> session 和 cookie

## 如何扣减库存

## 分布式锁

> 在分布式系统环境下，一个方法在同一时间只能被一个机器的一个线程执行；
> 高可用的获取锁与释放锁；
> 高性能的获取锁与释放锁；
> 具备可重入特性；
> 具备锁失效机制，防止死锁；
> 具备非阻塞锁特性，即没有获取到锁将直接返回获取锁失败。

- 基于缓存（Redis 等）实现分布式锁；

## 重复下单
